# 最终修正的部署命令

根据您收到的错误信息，我们需要修改部署命令以避免使用不支持的标志和参数。

## 构建命令 (Build Command)

```
bash simplified-build.sh
```

这会使用我们创建的简化构建脚本，避免使用导致错误的 esbuild 参数。如果您找不到这个简化脚本，请按照下面的步骤手动执行构建:

```
rm -rf dist && mkdir -p dist && NODE_ENV=production npx vite build && NODE_ENV=production npx esbuild server/index.ts --platform=node --bundle --format=esm --outfile=dist/index.js --external:express --external:pg --external:drizzle-orm
```

## 运行命令 (Run Command)

```
NODE_ENV=production node dist/index.js
```

## 手动部署步骤

如果您仍然遇到问题，可以尝试手动部署流程：

1. 在终端中运行以下命令制作构建文件:
   ```
   chmod +x simplified-build.sh
   ./simplified-build.sh
   ```

2. 构建成功后，确认有以下文件:
   - `dist/index.js` (服务器代码)
   - `dist/assets` (前端资源)

3. 测试应用能否在生产模式下本地运行:
   ```
   NODE_ENV=production node dist/index.js
   ```

4. 如果本地运行正常，则可以使用下面的命令进行部署。

## 修复 package.json 构建脚本

如果您希望永久修复这个问题，可以编辑 package.json 文件中的 build 脚本为:

```json
"build": "vite build && esbuild server/index.ts --platform=node --external:express --external:pg --external:drizzle-orm --bundle --format=esm --outfile=dist/index.js"
```

这样，以后使用标准的 npm run build 命令时也不会出现错误。