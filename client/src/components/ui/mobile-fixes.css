/* 针对手机设备的特定修复 */

/* 基础手机样式 - 确保手机设备有正确的布局 */
@media screen and (max-width: 767px) {
  /* 手机上侧边栏应该完全隐藏 */
  .sidebar-container {
    position: fixed !important;
    left: -100% !important;
    top: 0 !important;
    bottom: 0 !important;
    width: 85% !important; /* 更合适的宽度 */
    max-width: 320px !important;
    z-index: 1000 !important;
    transition: transform 0.3s ease !important;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.2) !important;
  }
  
  /* 当侧边栏可见时 */
  .sidebar-container.visible,
  .sidebar-container.translate-x-0 {
    transform: translateX(100%) !important;
    left: 0 !important;
  }
  
  /* 聊天内容区域应该占据全屏 */
  .chat-content-area {
    width: 100% !important;
    margin-left: 0 !important;
    left: 0 !important;
    right: 0 !important;
  }
  
  /* 输入区域应当贴合底部 */
  .chat-input-area {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    width: 100% !important;
    padding: 8px !important;
    z-index: 50 !important;
    background-color: inherit !important;
    backdrop-filter: blur(10px) !important;
  }
  
  /* 消息容器改进，确保消息居中显示 */
  .chat-message-container {
    padding-left: 12px !important;
    padding-right: 12px !important;
    width: 100% !important;
    max-width: 100% !important;
  }
  
  /* 减少消息边距，适应小屏幕 */
  .message-appear {
    max-width: 92% !important;
    margin: 8px auto !important;
  }
  
  /* 确保头部不会太大 */
  header.h-16 {
    height: 56px !important;
    padding-left: 16px !important;
    padding-right: 16px !important;
  }
  
  /* 调整输入区域的内边距 */
  .chat-input-container {
    padding: 8px 12px !important;
  }
}

/* 针对键盘激活状态的特殊处理 - 手机设备 */
@media screen and (max-width: 767px) {
  /* 当键盘打开时 */
  .keyboard-open .chat-message-container {
    padding-bottom: 60px !important;
    margin-bottom: 0 !important;
  }
  
  /* 键盘打开时固定输入框位置 */
  .keyboard-open .chat-input-area {
    position: fixed !important;
    bottom: 0 !important;
    transform: none !important;
    z-index: 100 !important;
  }
  
  /* 防止iOS中的视觉异常 */
  .keyboard-open body,
  .keyboard-open html {
    height: 100% !important;
    overflow: hidden !important;
  }
}

/* iOS特有修复 */
@supports (-webkit-touch-callout: none) {
  @media screen and (max-width: 767px) {
    /* 确保iOS键盘弹出时不会产生空白区域 */
    .keyboard-open .chat-input-area {
      position: fixed !important;
      bottom: 0 !important;
      padding-bottom: env(safe-area-inset-bottom, 0) !important;
    }
    
    /* iOS设备上的表单控件最小字体大小为16px，防止缩放 */
    input, 
    textarea {
      font-size: 16px !important;
    }
    
    /* 确保消息列表有足够的底部空间 */
    .keyboard-open .chat-message-container {
      padding-bottom: 100px !important;
    }
  }
}

/* 安卓特有修复 */
@supports not (-webkit-touch-callout: none) {
  @media screen and (max-width: 767px) {
    /* 安卓设备特殊处理 */
    .keyboard-open .chat-input-area {
      position: fixed !important;
      bottom: 0 !important;
    }
    
    /* 安卓键盘弹出时的内容调整 */
    .keyboard-open .chat-message-container {
      padding-bottom: 80px !important;
    }
  }
}