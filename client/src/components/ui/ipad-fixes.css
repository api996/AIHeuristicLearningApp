/* iPad和平板设备特定修复 - 采用现代响应式布局技术 */

/**
 * 主布局策略:
 * 1. 使用CSS Grid和Flexbox替代绝对定位
 * 2. 采用margin: 0 auto自动居中
 * 3. 通过max-width限制内容宽度
 * 4. 均匀分配可用空间
 */

/* ===== 基础平板/iPad布局(768px-1024px) ===== */
@media screen and (min-width: 768px) and (max-width: 1024px) {
  /* 主容器布局结构 - 使用Grid代替绝对定位 */
  .ipad-device .flex.h-screen,
  .tablet-device .flex.h-screen {
    display: grid !important;
    grid-template-columns: 256px 1fr !important; /* 固定侧边栏宽度，内容区域自适应 */
    grid-template-areas: "sidebar content" !important;
    height: 100vh !important;
    width: 100% !important;
    overflow: hidden !important;
  }
  
  /* 侧边栏定位 - 使用grid-area替代绝对定位 */
  .ipad-device .sidebar-container,
  .tablet-device .sidebar-container {
    grid-area: sidebar !important;
    position: relative !important; /* 改为相对定位 */
    width: 100% !important; /* 100%宽度填充grid cell */
    height: 100% !important;
    z-index: 40 !important;
    background-color: rgba(0, 0, 0, 0.8) !important;
    border-right: 1px solid rgba(255, 255, 255, 0.1) !important;
  }
  
  /* 内容区域定位 - 使用grid-area和flexbox替代绝对定位 */
  .ipad-device .chat-content-area,
  .tablet-device .chat-content-area {
    grid-area: content !important;
    position: relative !important; /* 改为相对定位 */
    width: 100% !important; /* 100%宽度填充grid cell */
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
  }
  
  /* 消息容器 - 采用响应式居中布局 */
  .ipad-device .chat-message-container,
  .tablet-device .chat-message-container {
    /* 核心自适应居中策略 */
    max-width: 85% !important; /* 限制最大宽度 */
    width: 100% !important; /* 填充可用空间 */
    margin-left: auto !important; /* 自动左右居中 */
    margin-right: auto !important;
    
    /* 平衡左右间距 */
    padding-left: 30px !important;
    padding-right: 30px !important;
    
    /* 容器本身采用flex布局 */
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    
    /* 避免使用position: relative + left/right */
    position: static !important;
    
    /* 添加调试边框 - 需要时可取消注释
    border: 1px solid rgba(0, 255, 0, 0.2) !important; */
  }
  
  /* 消息显示区域 */
  .ipad-device .vh-chat-messages,
  .tablet-device .vh-chat-messages {
    width: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
  }
  
  /* 每条消息的容器 - 确保居中 */
  .ipad-device .message-appear,
  .tablet-device .message-appear {
    width: 100% !important;
    max-width: 85% !important; /* 限制宽度使消息更集中 */
    margin-left: auto !important;
    margin-right: auto !important;
  }
  
  /* 聊天输入区域 - 自适应定位 */
  .ipad-device .chat-input-area,
  .tablet-device .chat-input-area {
    width: 100% !important; /* 100%宽度 */
    position: relative !important; /* 相对定位而非绝对定位 */
    left: auto !important; /* 取消固定偏移 */
    right: auto !important;
    margin: 0 auto !important; /* 自动居中 */
    max-width: 85% !important; /* 保持与消息容器一致的宽度 */
    bottom: 0 !important;
  }
  
  /* 键盘弹出时的输入区域调整 */
  .ipad-device.keyboard-open .chat-input-area,
  .tablet-device.keyboard-open .chat-input-area {
    position: fixed !important;
    bottom: 0 !important;
    z-index: 1000 !important;
    width: calc(100% - 256px) !important; /* 考虑侧边栏 */
    left: 256px !important; /* 与侧边栏对齐 */
  }
}

/* ===== iPad Pro和大尺寸平板布局(1024px-1366px) ===== */
@media screen and (min-width: 1024px) and (max-width: 1366px) {
  /* 应用同样的Grid布局策略 */
  .ipad-device .flex.h-screen,
  .tablet-device .flex.h-screen {
    display: grid !important;
    grid-template-columns: 256px 1fr !important;
    grid-template-areas: "sidebar content" !important;
  }
  
  /* 大屏幕平板消息容器 - 更宽但仍然居中 */
  .ipad-device .chat-message-container,
  .tablet-device .chat-message-container {
    max-width: 90% !important; /* 略微加宽 */
    width: 100% !important;
    margin: 0 auto !important; /* 自动居中 */
    padding-left: 20px !important; /* 简化内边距 */
    padding-right: 20px !important;
    position: static !important; /* 避免相对定位 */
  }
  
  /* 聊天输入区域保持居中 */
  .ipad-device .chat-input-area,
  .tablet-device .chat-input-area {
    width: 100% !important;
    max-width: 90% !important; /* 与消息容器匹配 */
    margin: 0 auto !important;
    position: relative !important;
    left: auto !important;
    right: auto !important;
  }
}

/* ===== 横屏模式特殊调整 ===== */
@media screen and (min-width: 768px) and (max-width: 1366px) and (orientation: landscape) {
  .ipad-device.landscape .chat-message-container,
  .tablet-device.landscape .chat-message-container {
    max-width: 80% !important; /* 横屏时适当收窄 */
    padding: 0 20px !important; /* 简化内边距 */
  }
  
  /* 横屏模式下消息显示 */
  .ipad-device.landscape .message-appear,
  .tablet-device.landscape .message-appear {
    max-width: 80% !important;
  }
}

/* ===== 竖屏模式特殊调整 ===== */
@media screen and (min-width: 768px) and (max-width: 1366px) and (orientation: portrait) {
  .ipad-device.portrait .chat-message-container,
  .tablet-device.portrait .chat-message-container {
    max-width: 90% !important; /* 竖屏时略微加宽 */
    padding: 0 20px !important;
  }
  
  /* 竖屏模式下消息显示 */
  .ipad-device.portrait .message-appear,
  .tablet-device.portrait .message-appear {
    max-width: 90% !important;
  }
}

/* ===== 响应式工具类 ===== */
/* 居中容器类 - 可应用于任何需要居中的容器 */
.centered-container {
  width: 100% !important;
  max-width: 85% !important;
  margin-left: auto !important;
  margin-right: auto !important;
  position: static !important;
}

/* 均衡灵活容器 - 在空间有限时自动压缩 */
.flex-centered-content {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: flex-start !important;
  width: 100% !important;
}